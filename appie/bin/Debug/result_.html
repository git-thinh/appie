<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title></title>
    <style type="text/css">
        body {
            padding: 20px 10px;
            margin: 0;
            font-size: 1.5em;
        }

        p {
            line-height: 1.7em;
        }
        
        a {
            text-decoration: none;
        } 

        img {
            max-width: 20% !important;
        }
        p.box_img___ {
            display:none;
            text-align:right;
        }
        p.box_img___ img{
        }
    </style> 
</head>
<body>
<a href="#start-of-content" tabindex="1" class="px-2 py-4 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
<div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>
<div class="container-lg d-flex px-3">
<div class="d-flex flex-justify-between flex-items-center">
<a class="header-logo-invertocat my-0" href="https://github.com/" aria-label="Homepage" data-ga-click="(Logged out) Header, go to homepage, icon:logo-wordmark">
</a>
</div>
<div class="HeaderMenu HeaderMenu--bright d-flex flex-justify-between flex-auto">
<ul class="d-flex list-style-none">
<li class="ml-2">
<a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:features" data-selected-links="/features /features/project-management /features/code-review /features/project-management /features/integrations /features" href="/features">
Features
</a>              </li>
<li class="ml-4">
<a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:business" data-selected-links="/business /business/security /business/customers /business" href="/business">
Business
</a>              </li>
<li class="ml-4">
<a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="/explore">
Explore
</a>              </li>
<li class="ml-4">
<a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:marketplace" data-selected-links=" /marketplace" href="/marketplace">
Marketplace
</a>              </li>
<li class="ml-4">
<a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:pricing" data-selected-links="/pricing /pricing/developer /pricing/team /pricing/business-hosted /pricing/business-enterprise /pricing" href="/pricing">
Pricing
</a>              </li>
</ul>
<div class="d-flex">
<div class="d-lg-flex flex-items-center mr-3">
<div class="header-search scoped-search site-scoped-search js-site-search position-relative js-jump-to"
role="search combobox"
aria-owns="jump-to-results"
aria-label="Search or jump to"
aria-haspopup="listbox"
aria-expanded="true"
>
<div class="position-relative">
<label class="form-control header-search-wrapper header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
<img src="https://assets-cdn.github.com/images/search-shortcut-hint.svg" alt="" class="mr-2 header-search-key-slash">
<div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
<ul class="d-none js-jump-to-suggestions-template-container">
<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item">
<a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center p-2 jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open" href="">
<div class="jump-to-octicon js-jump-to-octicon mr-2 text-center d-none"></div>
<img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar" alt="" aria-label="Team" src="" width="28" height="28">
<div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden no-wrap css-truncate css-truncate-target">
</div>
<div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
<span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
In this repository
</span>
<span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
All GitHub
</span>
<span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
</div>
<div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
Jump to
<span class="d-inline-block ml-1 v-align-middle">↵</span>
</div>
</a>
</li>
</ul>
<ul class="d-none js-jump-to-no-results-template-container">
<li class="d-flex flex-justify-center flex-items-center p-3 f5 d-none">
<span class="text-gray">No suggested jump to results</span>
</li>
</ul>
<ul id="jump-to-results" class="js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container" >
<li class="d-flex flex-justify-center flex-items-center p-0 f5">
<img src="https://assets-cdn.github.com/images/spinners/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
</li>
</ul>
</div>
</label>
</div>
</div>
</div>
<span class="d-inline-block">
<div class="HeaderNavlink px-0 py-2 m-0">
<a class="text-bold text-white no-underline" href="/login?return_to=%2FAngleSharp%2FAngleSharp%2Fwiki%2FExamples" data-ga-click="(Logged out) Header, clicked Sign in, text:sign-in">Sign in</a>
<span class="text-gray">or</span>
<a class="text-bold text-white no-underline" href="/join?source=header-repo" data-ga-click="(Logged out) Header, clicked Sign up, text:sign-up">Sign up</a>
</div>
</span>
</div>
</div>
</div>
</div>
<div id="start-of-content" class="show-on-focus"></div>
<div id="js-flash-container">
</div>
<div role="main" class="application-main ">
<div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
<div id="js-repo-pjax-container" data-pjax-container >
<div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav  ">
<div class="repohead-details-container clearfix container">
<ul class="pagehead-actions">
<li>
<a href="/login?return_to=%2FAngleSharp%2FAngleSharp"
class="btn btn-sm btn-with-count tooltipped tooltipped-n"
aria-label="You must be signed in to watch a repository" rel="nofollow">
Watch
</a>
<a class="social-count" href="/AngleSharp/AngleSharp/watchers"
aria-label="171 users are watching this repository">
171
</a>
</li>
<li>
<a href="/login?return_to=%2FAngleSharp%2FAngleSharp"
class="btn btn-sm btn-with-count tooltipped tooltipped-n"
aria-label="You must be signed in to star a repository" rel="nofollow">
Star
</a>
<a class="social-count js-social-count" href="/AngleSharp/AngleSharp/stargazers"
aria-label="2064 users starred this repository">
2,064
</a>
</li>
<li>
<a href="/login?return_to=%2FAngleSharp%2FAngleSharp"
class="btn btn-sm btn-with-count tooltipped tooltipped-n"
aria-label="You must be signed in to fork a repository" rel="nofollow">
Fork
</a>
<a href="/AngleSharp/AngleSharp/network" class="social-count"
aria-label="267 users forked this repository">
267
</a>
</li>
</ul>
<h1 class="public ">
<span class="author" itemprop="author"><a class="url fn" rel="author" href="/AngleSharp">AngleSharp</a></span><span class="path-divider">/</span><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="/AngleSharp/AngleSharp">AngleSharp</a></strong>
</h1>
</div>
<span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
<a class="js-selected-navigation-item reponav-item" itemprop="url" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /AngleSharp/AngleSharp" href="/AngleSharp/AngleSharp">
<span itemprop="name">Code</span>
</a>  </span>
<span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
<a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /AngleSharp/AngleSharp/issues" href="/AngleSharp/AngleSharp/issues">
<span itemprop="name">Issues</span>
<span class="Counter">36</span>
</a>    </span>
<span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
<a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /AngleSharp/AngleSharp/pulls" href="/AngleSharp/AngleSharp/pulls">
<span itemprop="name">Pull requests</span>
<span class="Counter">6</span>
</a>  </span>
<a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /AngleSharp/AngleSharp/projects" href="/AngleSharp/AngleSharp/projects">
Projects
<span class="Counter" >0</span>
</a>
<a class="js-selected-navigation-item selected reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /AngleSharp/AngleSharp/wiki" href="/AngleSharp/AngleSharp/wiki">
Wiki
</a>
<a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse /AngleSharp/AngleSharp/pulse" href="/AngleSharp/AngleSharp/pulse">
Insights
</a>
</div>
<div class="container new-discussion-timeline experiment-repo-nav  ">
<div class="repository-content ">
<div id="wiki-wrapper" class="wiki-wrapper page">
<div class="signup-prompt-bg rounded-1">
<div class="signup-prompt p-4 text-center mb-4 rounded-1">
<div class="position-relative">
Dismiss
<h3 class="pt-2">Join GitHub today</h3>
<p class="col-6 mx-auto">GitHub is home to over 28 million developers working together to host and review code, manage projects, and build software together.</p>
<a class="btn btn-primary" href="/join?source=prompt-wiki-show" data-ga-click="(Logged out) Sign up prompt, clicked Sign up, text:sign-up">Sign up</a>
</div>
</div>
</div>
<div class="gh-header">
<div class="gh-header-show">
<h1 class="gh-header-title instapaper_title">Examples</h1>
<div class="gh-header-meta">
Florian Rappl edited this page <relative-time datetime="2016-04-09T06:13:54Z">Apr 9, 2016</relative-time>
·
<a href="/AngleSharp/AngleSharp/wiki/Examples/_history" class="history">
18 revisions
</a>
</div>
</div>
</div>
<div id="wiki-content" class="wiki-content">
<div class="has-rightbar">
<div id="wiki-rightbar" class="wiki-rightbar">
<div class="wiki-pages-box readability-sidebar boxed-group flush js-wiki-pages-box " role="navigation">
<h3 class="js-wiki-toggle-collapse wiki-auxiliary-content">
Pages <span class="Counter">10</span>
</h3>
<div class="boxed-group-inner wiki-auxiliary-content wiki-auxiliary-content-no-bg">
<ul class="wiki-pages" data-filterable-for="wiki-pages-filter" data-filterable-type="substring">
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki">Home</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/Api">Api</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/ChangeLog">ChangeLog</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/Documentation">Documentation</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/Examples">Examples</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/Features">Features</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/Interfaces">Interfaces</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/Missing">Missing</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/Performance">Performance</a></strong>
</li>
<li>
<strong><a class="wiki-page-link" href="/AngleSharp/AngleSharp/wiki/TODO">TODO</a></strong>
</li>
</ul>
</div>
</div>
<h5 class="mt-0 mb-2">Clone this wiki locally</h5>
<div class="width-full input-group">
<span class="input-group-button">
<clipboard-copy for="wiki-clone-url" aria-label="Copy to clipboard" class="btn btn-sm zeroclipboard-button">
</clipboard-copy>
</span>
</div>
<a href="https://desktop.github.com"
class="btn btn-sm sidebar-button"
title="Save this wiki to your computer and use it in GitHub Desktop."
aria-label="Save this wiki to your computer and use it in GitHub Desktop.">
Clone in Desktop
</a>
</div>
<div id="wiki-body" class="wiki-body gollum-markdown-content instapaper_body">
<div class="markdown-body">
<h2>
<a id="user-content-anglesharp-examples" class="anchor" href="#anglesharp-examples" aria-hidden="true"></a>AngleSharp examples</h2>
<p>This is a (growing) list of examples for every-day usage of AngleSharp.</p>
<h3>
<a id="user-content-parsing-a-well-defined-document" class="anchor" href="#parsing-a-well-defined-document" aria-hidden="true"></a>Parsing a well-defined document</h3>
<p>Of course AngleSharp can handle well-defined documents very well. But what about a document that seems ill-defined, however, is in fact well-defined. The following document works, has no errors at all and is also used in production by Google. The serialized output of the document generation can be compared with the serialization done by browsers such as IE, Chrome or Firefox.</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span> <span class="pl-en">source </span>= @<span class="pl-s"><span class="pl-pds">"</span></span>
<span class="pl-s"><!DOCTYPE html></span>
<span class="pl-s"><html lang=en></span>
<span class="pl-s">  </span>
<span class="pl-s">  "</span><span class="pl-pds">"</span>initial-scale=1, minimum-scale=1, width=device-width<span class="pl-pds">"</span><span class="pl-pds">"</span>></span>
<span class="pl-s">  <title>Error 404 (Not Found)!!1</title></span>
<span class="pl-s">  <style></span>
<span class="pl-s">    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/errors/logo_sm_2.png) no-repeat}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/errors/logo_sm_2_hr.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/errors/logo_sm_2_hr.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/errors/logo_sm_2_hr.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:55px;width:150px}</span>
<span class="pl-s">  </style></span>
<span class="pl-s">  <a href=//www.google.com/><span id=logo aria-label=Google></span></a></span>
<span class="pl-s">  <p><b>404.</b> That’s an error.</span>
<span class="pl-s">  <p>The requested URL <code>/error</code> was not found on this server.  That’s all we know.<span class="pl-pds">"</span></span>;
<span class="pl-c">// Create a new parser front-end (can be re-used)</span>
<span class="pl-k">var</span> <span class="pl-en">parser </span>= <span class="pl-k">new</span> <span class="pl-en">HtmlParser</span>();
<span class="pl-c">//Just get the DOM representation</span>
<span class="pl-k">var</span> <span class="pl-en">document </span>= <span class="pl-en">parser.Parse</span>(source);
<span class="pl-c">//Serialize it back to the console</span>
<span class="pl-en">Console.WriteLine</span>(document.DocumentElement.OuterHtml);</pre></div>
<p>So we define some source code, call the <code>Parse</code> method of a an <code>HtmlParser</code> instance. The <code>Parse</code> method uses the provided source code to construct the DOM. Afterwards we serialize the DOM back to a string. Finally we output this string in the console.</p>
<h3>
<a id="user-content-simple-document-manipulation" class="anchor" href="#simple-document-manipulation" aria-hidden="true"></a>Simple document manipulation</h3>
<p>AngleSharp constructs a DOM according to the official HTML5 specification. This also means that the resulting model is fully interactive and could be used for simple manipulation. The following example creates a document and changes the tree structure by inserting another paragraph element with some text.</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">FirstExample</span>()
{
<span class="pl-k">var</span> <span class="pl-en">parser </span>= <span class="pl-k">new</span> <span class="pl-en">HtmlParser</span>();
<span class="pl-k">var</span> <span class="pl-en">document </span>= parser.Parse(<span class="pl-s"><span class="pl-pds">"</span><h1>Some example source</h1><p>This is a paragraph element<span class="pl-pds">"</span></span>);
<span class="pl-c">//Do something with document like the following</span>
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>Serializing the (original) document:<span class="pl-pds">"</span></span>);
Console.WriteLine(document.DocumentElement.OuterHtml);
<span class="pl-k">var</span> <span class="pl-en">p </span>= document.CreateElement(<span class="pl-s"><span class="pl-pds">"</span>p<span class="pl-pds">"</span></span>);
p.TextContent = <span class="pl-s"><span class="pl-pds">"</span>This is another paragraph.<span class="pl-pds">"</span></span>;
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>Inserting another element in the body ...<span class="pl-pds">"</span></span>);
document.Body.AppendChild(p);
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>Serializing the document again:<span class="pl-pds">"</span></span>);
Console.WriteLine(document.DocumentElement.OuterHtml);
}</pre></div>
<p>Here the parser will create a new <code>IHtmlDocument</code> instance, which is then queried to find some matching nodes. In the example code above we also create another <code>IElement</code>, which is the <code>IHtmlParagraphElement</code>. This one is then appended to the <code>Body</code> node of the document.</p>
<h3>
<a id="user-content-getting-certain-elements" class="anchor" href="#getting-certain-elements" aria-hidden="true"></a>Getting certain elements</h3>
<p>AngleSharp exposes all DOM lists as <code>IEnumerable<T></code> like <code>IEnumerable<Node></code> for the <code>NodeList</code> class. This allows us to use LINQ in combination with some already given DOM capabilities like the <code>QuerySelectorAll</code> method.</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">UsingLinq</span>()
{
<span class="pl-k">var</span> <span class="pl-en">parser </span>= <span class="pl-k">new</span> <span class="pl-en">HtmlParser</span>();
<span class="pl-k">var</span> <span class="pl-en">document </span>= parser.Parse(<span class="pl-s"><span class="pl-pds">"</span><ul><li>First item<li>Second item<li class='blue'>Third item!<li class='blue red'>Last item!</ul><span class="pl-pds">"</span></span>);
<span class="pl-c">//Do something with LINQ</span>
<span class="pl-k">var</span> <span class="pl-en">blueListItemsLinq </span>= document.All.Where(m => m.LocalName == <span class="pl-s"><span class="pl-pds">"</span>li<span class="pl-pds">"</span></span> && m.ClassList.Contains(<span class="pl-s"><span class="pl-pds">"</span>blue<span class="pl-pds">"</span></span>));
<span class="pl-c">//Or directly with CSS selectors</span>
<span class="pl-k">var</span> <span class="pl-en">blueListItemsCssSelector </span>= document.QuerySelectorAll(<span class="pl-s"><span class="pl-pds">"</span>li.blue<span class="pl-pds">"</span></span>);
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>Comparing both ways ...<span class="pl-pds">"</span></span>);
Console.WriteLine();
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>LINQ:<span class="pl-pds">"</span></span>);
<span class="pl-k">foreach</span> (var item <span class="pl-k">in</span> blueListItemsLinq)
Console.WriteLine(item.Text());
Console.WriteLine();
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>CSS:<span class="pl-pds">"</span></span>);
<span class="pl-k">foreach</span> (var item <span class="pl-k">in</span> blueListItemsCssSelector)
Console.WriteLine(item.Text());
}</pre></div>
<p>Since the <code>All</code> property of an <code>IDocument</code> returns all <code>IElement</code> nodes that are contained in a document, we can use it very efficiently with LINQ. On the other hand the <code>QuerySelectorAll</code> also returns (same as <code>All</code>) an <code>IHtmlCollection</code> object. Hence this can be filtered with LINQ as well! Additionally this list is already filtered.</p>
<p>It is also possible to get the same as <code>All</code> with a selector - the special asterisk <code>*</code> selector:</p>
<div class="highlight highlight-source-cs"><pre>    <span class="pl-c">//Same as document.All</span>
<span class="pl-k">var</span> <span class="pl-en">blueListItemsLinq </span>= <span class="pl-en">document.QuerySelectorAll</span>("*").<span class="pl-en">Where</span>(m => m.LocalName == <span class="pl-s"><span class="pl-pds">"</span>li<span class="pl-pds">"</span></span> && m.ClassList.Contains(<span class="pl-s"><span class="pl-pds">"</span>blue<span class="pl-pds">"</span></span>));</pre></div>
<p>Is this exactly the same? Actually no - <code>All</code> returns a so called <em>live</em> DOM list, i.e. if we save the object somewhere we will always have access to the latest DOM changes.</p>
<h3>
<a id="user-content-getting-single-elements" class="anchor" href="#getting-single-elements" aria-hidden="true"></a>Getting single elements</h3>
<p>Additionally we have the <code>QuerySelector</code> method. This one is quite close to LINQ statements that use <code>FirstOrDefault()</code> for generating results. The tree traversal might be a little bit more efficient using the <code>QuerySelector</code> method.</p>
<p>Let's see some sample code:</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">SingleElements</span>()
{
<span class="pl-k">var</span> <span class="pl-en">parser </span>= <span class="pl-k">new</span> <span class="pl-en">HtmlParser</span>();
<span class="pl-k">var</span> <span class="pl-en">document </span>= parser.Parse(<span class="pl-s"><span class="pl-pds">"</span><b><i>This is some <em> bold <u>and</u> italic </em> text!</i></b><span class="pl-pds">"</span></span>);
<span class="pl-k">var</span> <span class="pl-en">emphasize </span>= document.QuerySelector(<span class="pl-s"><span class="pl-pds">"</span>em<span class="pl-pds">"</span></span>);
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>Difference between several ways of getting text:<span class="pl-pds">"</span></span>);
Console.WriteLine();
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>Only from C# / AngleSharp:<span class="pl-pds">"</span></span>);
Console.WriteLine();
Console.WriteLine(emphasize.ToHtml());   <span class="pl-c">//<em> bold <u>and</u> italic </em></span>
Console.WriteLine(emphasize.Text());   <span class="pl-c">//boldanditalic</span>
Console.WriteLine();
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>From the DOM:<span class="pl-pds">"</span></span>);
Console.WriteLine();
Console.WriteLine(emphasize.InnerHtml);  <span class="pl-c">// bold <u>and</u> italic</span>
Console.WriteLine(emphasize.OuterHtml);  <span class="pl-c">//<em> bold <u>and</u> italic </em></span>
Console.WriteLine(emphasize.TextContent);<span class="pl-c">// bold and italic </span>
}</pre></div>
<p>The output commands try to demonstrate the differences between several ways of getting back strings from nodes. In fact the DOM property <code>OuterHtml</code> uses the <code>ToHtml()</code> version to generate the HTML code. The other variants are all different. While <code>Text()</code> is just a helper to strip text (and omit unwanted text contents like in <code></span>
<span class="pl-s">        </body><span class="pl-pds">"</span></span>;
<span class="pl-k">var</span> <span class="pl-en">document </span>= parser.Parse(source);
<span class="pl-c">//Modified HTML will be output</span>
Console.WriteLine(document.DocumentElement.OuterHtml);
}</pre></div>
<p>This code just parses the given HTML code, encounters the provided JavaScript and executes it. The JavaScript will manipulate the document at the given point, changing the title of the document and appending some more HTML to parse. In the end we will see, that the printed (serialized) HTML is different to the original one.</p>
<h3>
<a id="user-content-more-complex-javascript-dom-interaction" class="anchor" href="#more-complex-javascript-dom-interaction" aria-hidden="true"></a>More complex JavaScript DOM interaction</h3>
<p>Using JavaScript with AngleSharp is no problem. In the current state we can also easily use DOM manipulation like creating elements, appending or removing them.</p>
<p>The following example code performs DOM queries, creates new elements and removes existing ones.</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">ExtendedScriptingSample</span>()
{
<span class="pl-c">//We require a custom configuration with JavaScript and CSS</span>
<span class="pl-k">var</span> <span class="pl-en">config </span>= Configuration.Default.WithJavaScript().WithCss();
<span class="pl-c">//Let's create a new parser using this configuration</span>
<span class="pl-k">var</span> <span class="pl-en">parser </span>= <span class="pl-k">new</span> <span class="pl-en">HtmlParser</span>(<span class="pl-en">config</span>);
<span class="pl-c">//This is our sample source, we will do some DOM manipulation</span>
<span class="pl-k">var</span> <span class="pl-en">source </span>= @<span class="pl-s"><span class="pl-pds">"</span><!doctype html></span>
<span class="pl-s">        <html></span>
<span class="pl-s">        <head><title>Sample</title></head></span>
<span class="pl-s">        <style></span>
<span class="pl-s">        .bold {</span>
<span class="pl-s">        font-weight: bold;</span>
<span class="pl-s">        }</span>
<span class="pl-s">        .italic {</span>
<span class="pl-s">        font-style: italic;</span>
<span class="pl-s">        }</span>
<span class="pl-s">        span {</span>
<span class="pl-s">        font-size: 12pt;</span>
<span class="pl-s">        }</span>
<span class="pl-s">        div {</span>
<span class="pl-s">        background: #777;</span>
<span class="pl-s">        color: #f3f3f3;</span>
<span class="pl-s">        }</span>
<span class="pl-s">        </style></span>
<span class="pl-s">        <body></span>
<span class="pl-s">        <div id=content></div></span>
<span class="pl-s">        </span>
<span class="pl-s">        </body><span class="pl-pds">"</span></span>;
<span class="pl-k">var</span> <span class="pl-en">document </span>= parser.Parse(source);
<span class="pl-c">//HTML will have changed completely (e.g., no more script element)</span>
Console.WriteLine(document.DocumentElement.OuterHtml);
}</pre></div>
<p>In principle other JavaScript engines can be added as well. Of course manually wrapping the objects would give a superior performance compared to the automatic version that is based on reflection. Nevertheless the <code>AngleSharp.Scripting.JavaScript</code> library (available on NuGet) shows the possibilities and the basics of binding an existing JavaScript engine to AngleSharp.</p>
<h3>
<a id="user-content-events-in-javascript-and-c" class="anchor" href="#events-in-javascript-and-c" aria-hidden="true"></a>Events in JavaScript and C#</h3>
<p>The beginning of the following example is exactly the same as the previous two examples. We create a custom configuration, which contains the <code>JavaScriptEngine</code> engine. After enabling scripting (and styling in this case), we can parse our document.</p>
<p>The sample document of this example consists of a single script, that calls the <code>console.log</code> method. One time before adding a listener, another time after adding the listener.</p>
<p>The listener is called once the document is fully loaded. This happens after executing the provided JavaScript, hence we should see this event at the end. We also registered another event listener, which will be invoked once the custom event <strong>hello</strong> is dispatched.</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">EventScriptingExample</span>()
{
<span class="pl-c">//We require a custom configuration</span>
<span class="pl-k">var</span> <span class="pl-en">config </span>= Configuration.Default.WithJavaScript();
<span class="pl-c">//Let's create a new parser using this configuration</span>
<span class="pl-k">var</span> <span class="pl-en">parser </span>= <span class="pl-k">new</span> <span class="pl-en">HtmlParser</span>(<span class="pl-en">config</span>);
<span class="pl-c">//This is our sample source, we will trigger the load event</span>
<span class="pl-k">var</span> <span class="pl-en">source </span>= @<span class="pl-s"><span class="pl-pds">"</span><!doctype html></span>
<span class="pl-s">        <html></span>
<span class="pl-s">        <head><title>Event sample</title></head></span>
<span class="pl-s">        <body></span>
<span class="pl-s">        </span>
<span class="pl-s">        </body><span class="pl-pds">"</span></span>;
<span class="pl-k">var</span> <span class="pl-en">document </span>= parser.Parse(source);
<span class="pl-c">//HTML should be output in the end</span>
Console.WriteLine(document.DocumentElement.OuterHtml);
<span class="pl-c">//Register Hello event listener from C# (we also have one in JS)</span>
document.AddEventListener(<span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>, (s, ev) =>
{
Console.WriteLine(<span class="pl-s"><span class="pl-pds">"</span>hello world from C#!<span class="pl-pds">"</span></span>);
});
<span class="pl-k">var</span> <span class="pl-en">e </span>= document.CreateEvent(<span class="pl-s"><span class="pl-pds">"</span>event<span class="pl-pds">"</span></span>);
e.Init(<span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>, <span class="pl-c1">false</span>, <span class="pl-c1">false</span>);
document.Dispatch(e);
}</pre></div>
<p>We also register an event listener for this custom event in C#. Here we have intellisense and all other comfortable tools. After initiating the event via the official API we will recognize output from both - JavaScript and C# - registered event listeners.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="modal-backdrop js-touch-events"></div>
</div>
</div>
</div>
</div>
<div class="footer container-lg px-3" role="contentinfo">
<div class="position-relative d-flex flex-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
<ul class="list-style-none d-flex flex-wrap ">
<li class="mr-3">© 2018 <span title="0.19125s from unicorn-6b7cbcf989-vfg8k">GitHub</span>, Inc.</li>
<li class="mr-3"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
<li class="mr-3"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
<li class="mr-3"><a href="https://help.github.com/articles/github-security/" data-ga-click="Footer, go to security, text:security">Security</a></li>
<li class="mr-3"><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
<li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com">Help</a></li>
</ul>
<a aria-label="Homepage" title="GitHub" class="footer-octicon" href="https://github.com">
</a>
<ul class="list-style-none d-flex flex-wrap ">
<li class="mr-3"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
<li class="mr-3"><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
<li class="mr-3"><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
<li class="mr-3"><a href="https://shop.github.com" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
<li class="mr-3"><a href="https://blog.github.com" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
<li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>
</ul>
</div>
<div class="d-flex flex-justify-center pb-6">
<span class="f6 text-gray-light"></span>
</div>
</div>
<div id="ajax-error-message" class="ajax-error-message flash flash-error">
You can’t perform that action at this time.
</div>
<div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner d-none">
<span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
<span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
</div>
<div class="facebox-popup">
<div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
</div>
</div>
</div>
</div>
</div>
<div id="hovercard-aria-description" class="sr-only">
Press h to open a hovercard with more details.
</div>
</body>
</html>
<script type="text/javascript">
    
    var htm;
    findMain(document.body.childNodes, 0);
    //console.log('OK: ', htm == null ? 'NULL -> find H1' : htm.length);
    if (htm == null) findH1();
    if (htm == null) {
        //console.log('FAILLL: ');
        cleanHtml(document.getElementsByTagName('*'));
    } else document.body.innerHTML = htm;

    function findH1() {
        var h1s = document.getElementsByTagName('h1');
        if (h1s.length > 0) {
            var it = h1s[h1s.length - 1].parentNode;
            while (it.parentNode.tagName != 'BODY') {
                it = it.parentNode;
            }
            var bs = document.getElementsByClassName(it.className);
            if (bs.length > 1) {
                for (var i = 0; i < bs.length; i++) {
                    cleanHtml(bs[i].getElementsByTagName('*'));
                    if (htm == null)
                        htm = bs[i].innerHTML;
                    else
                        htm += bs[i].innerHTML;
                }
            } else {
                //console.log('OK = ' + h1s.length, it);
                cleanHtml(it.getElementsByTagName('*'));
                htm = it.innerHTML;
            }
        }
    }

    function findMain(elements) {
        for (var i = 0; i < elements.length; i++) {
            var it = elements[i], css = it.className, id = it.id, tagName = it.tagName, text = it.textContent, ok = false;

            if (it.hasChildNodes() == false) {
                //console.log('REMOVE: ', it);
                it.parentNode.removeChild(it);
            } else {
                if (css == null) css = ''; else css = css.toLowerCase();
                if (id == null) id = ''; else id = id.toLowerCase();
                if (text == null) text = ''; else text = text.trim();
                if (id.length == 0 && css.length == 0 || text.length == 0) continue;

                ok = is_content(id, css, tagName, text);

                if (ok) {
                    var h1 = it.getElementsByTagName('h1').length;
                    if (htm == null && h1 > 0) {
                        //console.log('OK = ' + h1, it);
                        cleanHtml(it.getElementsByTagName('*'));
                        htm = it.innerHTML;
                    }
                    //return;
                } else {
                    //console.log(id + ': ' + css + ' remove = ' + is_remove(id, css), htm);
                    if (htm != null || is_remove(id, css)) {
                        //console.log('remove: ', it);
                        it.parentNode.removeChild(it);
                    } else
                        findMain(it.childNodes);
                }
            }
        }
    }

    function is_content(id, css, tagName, text) {
        var ok = (id.length > 0 && id.indexOf('main') != -1) || (css.length > 0 && css.indexOf('main') != -1)
            || (id.length > 0 && id.indexOf('content') != -1) || (css.length > 0 && css.indexOf('content') != -1);
        if (ok) {
            if (
            id.indexOf('menu') != -1
            || css.indexOf('menu') != -1
            || id.indexOf('search') != -1
            || css.indexOf('search') != -1
            || id.indexOf('header') != -1
            || css.indexOf('header') != -1
            || id.indexOf('footer') != -1
            || css.indexOf('footer') != -1
            || id.indexOf('cookie') != -1
            || css.indexOf('cookie') != -1
            || id.indexOf('feedback') != -1
            || css.indexOf('feedback') != -1
            || id.indexOf('error') != -1
            || css.indexOf('error') != -1
            ) return false;
            return true;
        }
        return false;
    }

    function cleanHtml(elements) {
        for (var i = 0; i < elements.length; i++) {
            var it = elements[i], css = it.className, id = it.id, tagName = it.tagName, text = it.textContent, ok = false;
            if (is_remove(id, css)) it.parentNode.removeChild(it);
        }
    }

    function is_remove(id, css) {
        return id.indexOf('search') != -1
            || css.indexOf('search') != -1
            || id.indexOf('header') != -1
            || css.indexOf('header') != -1
            || id.indexOf('footer') != -1
            || css.indexOf('footer') != -1
            || id.indexOf('cookie') != -1
            || css.indexOf('cookie') != -1
            || id.indexOf('newsletter') != -1
            || css.indexOf('newsletter') != -1
            || id.indexOf('breadcrumb') != -1
            || css.indexOf('breadcrumb') != -1
            || id.indexOf('metadata') != -1
            || css.indexOf('metadata') != -1
            || id.indexOf('feedback') != -1
            || css.indexOf('feedback') != -1
            || id.indexOf('sidebar') != -1
            || css.indexOf('sidebar') != -1
            || id.indexOf('page-background') != -1
            || css.indexOf('page-background') != -1
            || id.indexOf('share-') != -1
            || css.indexOf('share-') != -1
            || id.indexOf('share-') != -1
            || css.indexOf('-action') != -1
            || id.indexOf('nav-') != -1
            || css.indexOf('nav-') != -1
            || id.indexOf('error') != -1
            || css.indexOf('error') != -1;
    }

    </script>